<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Vue formulaire du wizard -->
    <record id="view_workflow_request_wizard_form" model="ir.ui.view">
        <field name="name">workflow.request.wizard.form</field>
        <field name="model">workflow.request.wizard</field>
        <field name="arch" type="xml">
            <form string="Cr√©er une demande" class="o_workflow_wizard_form">
                <sheet>
                    <!-- En-t√™te -->
                    <div class="oe_title mb-3">
                        <h1 style="font-size: 28px; font-weight: 700; color: #1a1a1a; margin: 0;">
                            Cr√©er une demande
                        </h1>
                        <p style="color: #666; margin: 0.5rem 0 0 0; font-size: 14px;">
                            Renseignez les informations du dossier de cr√©dit
                        </p>
                    </div>

                    <div class="o_wizard_container">
                        <!-- ============ SECTION 1: INFORMATIONS CLIENT ============ -->
                        <div class="o_wizard_section">
                            <h3 class="o_wizard_section_title">üë§ Informations client</h3>
                            <group>
                                <group>
                                    <field name="client_number" 
                                           placeholder="ex. CLT-2026-00784"
                                           class="o_field_required"/>
                                    <field name="account_number" 
                                           placeholder="ex. 001-78459632-01"
                                           class="o_field_required"/>
                                </group>
                                <group>
                                    <field name="client_name" 
                                           placeholder="Nom complet"
                                           class="o_field_required"/>
                                    <field name="credit_type" 
                                           class="o_field_required"/>
                                </group>
                            </group>
                        </div>

                        <!-- ============ SECTION 2: D√âTAILS FINANCIERS ============ -->
                        <div class="o_wizard_section">
                            <h3 class="o_wizard_section_title">üí∞ D√©tails financiers</h3>
                            <group>
                                <group>
                                    <field name="workflow_type_id" 
                                           class="o_field_required"
                                           options="{'no_create': True, 'no_open': True}"/>
                                    <field name="subject" 
                                           placeholder="ex. Pr√™t personnel logement"
                                           class="o_field_required"/>
                                    <field name="amount" 
                                           placeholder="0"
                                           class="o_field_required o_workflow_amount"/>
                                    <field name="currency_id" invisible="1"/>
                                </group>
                                <group>
                                    <field name="duration_months" 
                                           placeholder="ex. 60"/>
                                    <field name="priority"/>
                                </group>
                            </group>
                            
                            <!-- Aper√ßu circuit d√©tect√© -->
                            <div class="o_routing_preview">
                                <field name="detected_circuit_info" nolabel="1"/>
                            </div>
                        </div>

                        <!-- ============ SECTION 3: DESCRIPTION ============ -->
                        <div class="o_wizard_section">
                            <h3 class="o_wizard_section_title">üìù Contexte et justification</h3>
                            <field name="description" 
                                   placeholder="D√©crivez le contexte et les justifications de cette demande de cr√©dit..."
                                   nolabel="1"/>
                        </div>

                        <!-- ============ SECTION 4: R√âF√âRENCE & PI√àCES ============ -->
                        <div class="o_wizard_section">
                            <h3 class="o_wizard_section_title">üîñ R√©f√©rence &amp; pi√®ces</h3>
                            <group>
                                <group>
                                    <field name="reference_preview" 
                                           readonly="1"
                                           class="o_field_reference_preview"/>
                                </group>
                                <group>
                                    <field name="attachment_ids" widget="many2many_binary" nolabel="1"/>
                                </group>
                            </group>
                        </div>
                    </div>
                </sheet>

                <!-- Footer avec boutons -->
                <footer>
                    <button string="üíæ Enregistrer en brouillon" 
                            name="action_save_draft" 
                            type="object" 
                            class="btn-secondary"/>
                    <button string="üöÄ Soumettre la demande" 
                            name="action_submit_request" 
                            type="object" 
                            class="btn-primary oe_highlight"/>
                    <button string="Annuler" 
                            class="btn-link" 
                            special="cancel"/>
                </footer>
            </form>
        </field>
    </record>

    <!-- Action pour ouvrir le wizard -->
    <record id="action_workflow_request_wizard" model="ir.actions.act_window">
        <field name="name">Cr√©er une demande</field>
        <field name="res_model">workflow.request.wizard</field>
        <field name="view_mode">form</field>
        <field name="target">new</field>
        <field name="binding_model_id" ref="model_workflow_request"/>
        <field name="binding_view_types">form,tree</field>
    </record>

</odoo>
