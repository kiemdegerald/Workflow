<?xml version="1.0" encoding="utf-8"?>
<odoo>
    
    <!-- Vue liste de sÃ©lection: Mes demandes en attente -->
    <record id="view_workflow_request_approval_selector_tree" model="ir.ui.view">
        <field name="name">workflow.request.approval.selector.tree</field>
        <field name="model">workflow.request.approval</field>
        <field name="arch" type="xml">
            <tree string="Mes demandes en attente" create="false" delete="false" edit="false" decoration-info="1">
                <field name="workflow_request_id" string="Demande"/>
                <field name="workflow_request_id" string="RÃ©fÃ©rence" widget="char"/>
                <field name="level_id" string="Niveau"/>
                <field name="create_date" string="Date de rÃ©ception"/>
                <button name="action_open_from_selector" type="object" string="ðŸ“‹ Traiter cette demande" class="btn-primary"/>
            </tree>
        </field>
    </record>

    <!-- Action: Liste de sÃ©lection des demandes -->
    <record id="action_workflow_approval_selector" model="ir.actions.act_window">
        <field name="name">SÃ©lectionnez une demande Ã  traiter</field>
        <field name="res_model">workflow.request.approval</field>
        <field name="view_mode">tree</field>
        <field name="view_id" ref="view_workflow_request_approval_selector_tree"/>
        <field name="domain">[('approver_id', '=', uid), ('state', '=', 'pending')]</field>
        <field name="context">{}</field>
        <field name="target">new</field>
    </record>
    
    <!-- Vue formulaire: Vue Approbateur -->
    <record id="view_workflow_approval_view_form" model="ir.ui.view">
        <field name="name">workflow.approval.view.form</field>
        <field name="model">workflow.approval.view</field>
        <field name="arch" type="xml">
            <form string="Vue Approbateur">
                <sheet>
                    <field name="request_id" invisible="1"/>
                    <field name="current_approval_id" invisible="1"/>
                    
                    <!-- Affichage HTML du dossier complet -->
                    <field name="approval_html" widget="html" nolabel="1"/>
                    
                    <!-- SÃ©parateur visuel -->
                    <div style="margin: 2rem 0; border-top: 2px solid #dee2e6;"></div>
                    
                    <!-- Section Actions pleine largeur -->
                    <div style="background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%); border: 2px solid #0a4b78; border-radius: 12px; padding: 2rem; margin: 1rem 0;">
                        <h3 style="margin: 0 0 0.5rem 0; font-size: 20px; font-weight: 700; color: #0a4b78;">âš¡ Actions disponibles</h3>
                        <p style="margin: 0 0 2rem 0; color: #6c757d; font-size: 14px;">Choisissez une action et ajoutez obligatoirement un commentaire</p>
                        
                        <!-- Boutons d'action sur 3 colonnes -->
                        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem; margin-bottom: 2rem;">
                            <button name="action_approve" type="object" string="âœ“ Valider" style="padding: 1.5rem !important; font-size: 18px !important; background-color: #4caf50 !important; color: white !important; border: none !important; border-radius: 10px !important; cursor: pointer !important; font-weight: 700 !important; box-shadow: 0 4px 6px rgba(76, 175, 80, 0.3) !important; text-align: center !important;"/>
                            <button name="action_return" type="object" string="â†© Retourner au niveau prÃ©cÃ©dent" style="padding: 1.5rem !important; font-size: 18px !important; background-color: #ff9800 !important; color: white !important; border: none !important; border-radius: 10px !important; cursor: pointer !important; font-weight: 700 !important; box-shadow: 0 4px 6px rgba(255, 152, 0, 0.3) !important; text-align: center !important;"/>
                            <button name="action_reject" type="object" string="âœ— Refuser" style="padding: 1.5rem !important; font-size: 18px !important; background-color: #f44336 !important; color: white !important; border: none !important; border-radius: 10px !important; cursor: pointer !important; font-weight: 700 !important; box-shadow: 0 4px 6px rgba(244, 67, 54, 0.3) !important; text-align: center !important;"/>
                        </div>
                        
                        <!-- Zone de commentaire large -->
                        <div>
                            <label for="comment" style="display: block; margin-bottom: 0.75rem; font-weight: 700; font-size: 15px; color: #1a1a1a;">
                                <span style="color: #dc3545;">*</span> Commentaire obligatoire
                            </label>
                            <field name="comment" placeholder="Saisissez votre commentaire ou vos instructions de correction..." nolabel="1" widget="text" style="width: 100%; min-height: 150px; padding: 1rem; border: 2px solid #dee2e6; border-radius: 8px; font-size: 15px; resize: vertical;"/>
                        </div>
                    </div>
                </sheet>
            </form>
        </field>
    </record>

    <!-- Action: Ouvrir la vue approbateur -->
    <record id="action_workflow_approval_view" model="ir.actions.server">
        <field name="name">Vue Approbateur</field>
        <field name="model_id" ref="model_workflow_approval_view"/>
        <field name="state">code</field>
        <field name="code">
action = model.action_open_approval_view()
        </field>
    </record>

</odoo>
